const _0x3a6190=(function(){let _0x21d30f=!![];return function(_0x3319ea,_0x112642){const _0x21f953=_0x21d30f?function(){if(_0x112642){const _0x44e08d=_0x112642['apply'](_0x3319ea,arguments);return _0x112642=null,_0x44e08d;}}:function(){};return _0x21d30f=![],_0x21f953;};}()),_0x2470ac=_0x3a6190(this,function(){return _0x2470ac['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](_0x2470ac)['search']('(((.+)+)+)+$');});_0x2470ac();import _0x65a163 from'./RouteStop.js';import _0xc7ea4 from'../Ext/buildModuleUrl.js';import _0x4f4db3 from'../Ext/XmlParser.js';import _0xdf5dfd from'./StopPlayMode.js';import _0x425237 from'../Mixin/Common.js';const _0x4cd1f7=Cesium['DeveloperError'],_0x2429e4=Cesium['Cartesian3'],_0x13cf13=Cesium['defaultValue'],_0x3748fb=Cesium['defined'],_0x4ef17b=Cesium['Math'],_0x1bb65f=Cesium['Transforms'],_0x6af967=Cesium['AssociativeArray'];function _0x431413(_0x3adca5){_0x3adca5=_0x3adca5||{},this['_stopCollection']=new _0x6af967(),this['_isStopVisible']=_0x13cf13(_0x3adca5['isStopVisible'],![]),this['_stopMarkCollection']=[],this['_isFlyLoop']=_0x13cf13(_0x3adca5['isFlyLoop'],![]),this['_isLineVisible']=_0x13cf13(_0x3adca5['isLineVisible'],![]),this['_lineEntity']=undefined,this['_routeName']=_0x13cf13(_0x3adca5['routeName'],''),this['_speed']=_0x13cf13(_0x3adca5['speed'],0x32),this['_isAlongline']=_0x13cf13(_0x3adca5['isAlongline'],![]),this['_totalDuration']=_0x13cf13(_0x3adca5['totalDuration'],0x0),this['_isHeadingFree']=!this['_isAlongline']&&_0x13cf13(_0x3adca5['isHeadingFree'],![]),this['_isTiltFree']=_0x13cf13(_0x3adca5['isTiltFree'],![]),this['_isAltitudeFree']=_0x13cf13(_0x3adca5['isAltitudeFree'],![]),this['_entityCollection']=_0x3adca5['entityCollection'],this['_catmullRomSpline']=undefined,this['_isCleared']=![],this['_stopsInfo']=_0x13cf13(_0x3adca5['stopsInfo'],{}),this['_removeIndex']=[],this['_addedStops']=[];}Object['defineProperties'](_0x431413['prototype'],{'stopCollection':{'get':function(){return this['_stopCollection']['values'];}},'isStopVisible':{'get':function(){return this['_isStopVisible'];},'set':function(_0x2093a2){_0x3748fb(_0x2093a2)&&_0x2093a2!==this['_isStopVisible']&&(this['_isStopVisible']=_0x2093a2,this['setStopVisible']());}},'isFlyLoop':{'get':function(){return this['_isFlyLoop'];},'set':function(_0x8d52e0){_0x8d52e0&&(this['_isFlyLoop']=_0x8d52e0);}},'isLineVisible':{'get':function(){return this['_isLineVisible'];},'set':function(_0x239b5b){_0x3748fb(_0x239b5b)&&_0x239b5b!==this['_isLineVisible']&&(this['_isLineVisible']=_0x239b5b,this['setLineVisible']());}},'lineEntity':{'get':function(){return this['_lineEntity'];},'set':function(_0x59566a){_0x3748fb(_0x59566a)&&(this['_lineEntity']=_0x59566a);}},'routeName':{'get':function(){return this['_routeName'];},'set':function(_0xe38d34){_0xe38d34&&(this['_routeName']=_0xe38d34);}},'speed':{'get':function(){return this['_speed'];},'set':function(_0x56a700){if(_0x56a700&&_0x56a700!=this['_speed']){this['_speed']=_0x56a700;let _0x225c1d=this['speed'],_0x4b6c67=this['stopCollection'];for(let _0x1dc440=0x0,_0x9a612d=_0x4b6c67['length'];_0x1dc440<_0x9a612d-0x1;_0x1dc440++){let _0x2e443b=_0x4b6c67[_0x1dc440];_0x2e443b['duration']=Math['ceil'](_0x2e443b['distanceToNext']/_0x225c1d);}}}},'stopCount':{'get':function(){return this['_stopCollection']['length'];}},'isAlongline':{'get':function(){return this['_isAlongline'];},'set':function(_0x2afb2e){_0x3748fb(_0x2afb2e)&&(this['_isAlongline']=_0x2afb2e);}},'totalDuration':{'get':function(){return this['_totalDuration'];}},'isHeadingFree':{'get':function(){return this['_isHeadingFree'];},'set':function(_0x127fa7){_0x3748fb(_0x127fa7)&&(this['_isHeadingFree']=_0x127fa7);}},'isTiltFree':{'get':function(){return this['_isTiltFree'];},'set':function(_0x4d0976){_0x3748fb(_0x4d0976)&&(this['_isTiltFree']=_0x4d0976);}},'isAltitudeFree':{'get':function(){return this['_isAltitudeFree'];},'set':function(_0x4e1264){_0x3748fb(_0x4e1264)&&(this['_isAltitudeFree']=_0x4e1264);}}}),_0x431413['prototype']['init']=function(){let _0x5016ba=0x0,_0x46985e=[0x0],_0x204171=[],_0x21e172=this['_stopsInfo']['stopNodes'];const _0x1d39b2=this['_stopsInfo']['namespace'];_0x3748fb(_0x21e172)?_0x21e172=_0x21e172['concat'](this['_addedStops']):_0x21e172=this['_addedStops'];for(let _0x40d996=0x0;_0x40d996<_0x21e172['length'];_0x40d996++){if(this['_removeIndex']['indexOf'](_0x40d996)>-0x1)continue;let _0x3ba1a8=_0x21e172[_0x40d996],_0x46dc7a,_0x22145e,_0x5e673d;if(!(_0x3ba1a8 instanceof _0x65a163)){let _0x4296dd=_0x4f4db3['queryFirstNode'](_0x3ba1a8,'camera',_0x1d39b2);const _0x47baef=_0x4f4db3['queryNumericValue'](_0x4296dd,'longitude',_0x1d39b2),_0x2c7ab1=_0x4f4db3['queryNumericValue'](_0x4296dd,'latitude',_0x1d39b2),_0x24869a=_0x4f4db3['queryNumericValue'](_0x4296dd,'altitude',_0x1d39b2);let _0x405a33=_0x4f4db3['queryNumericValue'](_0x4296dd,'heading',_0x1d39b2);_0x405a33=_0x4ef17b['toRadians'](_0x405a33);let _0x95443=_0x4f4db3['queryNumericValue'](_0x4296dd,'tilt',_0x1d39b2);_0x95443=_0x4ef17b['toRadians'](_0x95443-0x5a);this['_isAlongline']&&!this['_isTiltFree']&&(_0x95443=0x0);const _0x2081ac=_0x4f4db3['queryStringValue'](_0x4296dd,'altitudeMode',_0x1d39b2),_0xf380b2=_0x4f4db3['queryStringAttribute'](_0x3ba1a8,'name'),_0x54917b=_0x4f4db3['queryNumericAttribute'](_0x3ba1a8,'speed',_0x1d39b2),_0x4e5149=_0x4f4db3['queryFirstNode'](_0x3ba1a8,'setting',_0x1d39b2);_0x5e673d=_0x4f4db3['queryStringValue'](_0x4e5149,'stopPlayMode',_0x1d39b2);const _0x1916e4=_0x4f4db3['queryNumericValue'](_0x4e5149,'pauseTime',_0x1d39b2),_0x150e86=_0x4f4db3['queryNumericValue'](_0x4e5149,'angularSpeed',_0x1d39b2),_0xbee657=_0x4f4db3['queryFirstNode'](_0x4e5149,'stopViews',_0x1d39b2);let _0x5f22cf,_0x2e1575=!![];_0x47baef>0xb4||_0x2c7ab1>0xb4?(_0x5f22cf=new _0x2429e4(_0x47baef,_0x2c7ab1,_0x24869a),_0x2e1575=![]):_0x5f22cf=_0x2429e4['fromDegrees'](_0x47baef,_0x2c7ab1,_0x24869a);_0x204171['push'](_0x5f22cf);let _0x8c1948=this['stopCount'];if(_0x40d996>0x0&&_0x8c1948>0x0){_0x22145e=this['_stopCollection']['_array'][this['_stopCollection']['length']-0x1];if(_0x22145e['stopPlayMode']!=_0xdf5dfd['StopAround']){const _0x7894c0=_0x22145e['point'],_0x30266c=_0x2429e4['distance'](_0x7894c0,_0x5f22cf);_0x22145e['distanceToNext']=_0x30266c;let _0x3bd553=_0x22145e['speed'],_0x514910;0x0<_0x3bd553?_0x514910=_0x3bd553:_0x514910=this['_speed'],_0x22145e['duration']=_0x30266c/_0x514910,_0x22145e['speed']=_0x514910,_0x5016ba+=_0x22145e['duration'],_0x46985e['push'](_0x5016ba);}}_0x46dc7a=new _0x65a163({'index':_0x40d996,'point':_0x5f22cf,'heading':_0x405a33,'tilt':_0x95443,'stopName':_0xf380b2,'waitTime':_0x1916e4,'speed':_0x54917b,'isConvert':_0x2e1575}),_0x46dc7a['altitude']=_0x24869a;}else _0x46dc7a=_0x3ba1a8;this['_addStop'](_0x46dc7a);_0x3748fb(_0x22145e)&&(_0x22145e['_nextStopIndex']=_0x40d996,_0x46dc7a['_preStopIndex']=_0x22145e['index']);if(_0x5e673d===_0xdf5dfd['StopAround']&&stopsViesNode){const _0x5c5b5f=queryChildNodes(stopsViesNode,'view',_0x1d39b2);if(_0x5c5b5f['length']==0x2){const _0x31149f=_0x5c5b5f[0x0],_0x1a4844=_0x5c5b5f[0x1],_0xc33d3a=_0x4f4db3['queryNumericAttribute'](_0x31149f,'heading',_0x1d39b2),_0x5d892e=_0x4f4db3['queryNumericAttribute'](_0x1a4844,'heading',_0x1d39b2),_0x30f1cf=_0x4f4db3['queryNumericAttribute'](_0x31149f,'tilt',_0x1d39b2),_0x12b024=_0x4f4db3['queryNumericAttribute'](_0x1a4844,'tilt',_0x1d39b2),_0x1ba225=_0x4f4db3['queryNumericAttribute'](_0x31149f,'altitude',_0x1d39b2),_0x2a55a9=_0x4f4db3['queryNumericAttribute'](_0x1a4844,'altitude',_0x1d39b2),_0x410cfb=_0x4f4db3['queryStringAttribute'](_0x31149f,'direction',_0x1d39b2),_0x2ff541=_0x4f4db3['queryStringAttribute'](_0x1a4844,'direction',_0x1d39b2);let _0x24d3b3,_0x2a14fa=_0x410cfb==='Clockwise'?0x1:-0x1;if(_0x4ef17b['equalsEpsilon'](_0xc33d3a,_0x5d892e,_0x4ef17b['EPSILON15']))_0x24d3b3=0x168;else{_0x24d3b3=_0x5d892e-_0xc33d3a;if(_0x24d3b3<0x0&&_0x410cfb==='Clockwise')_0x24d3b3+=0x168;else _0x24d3b3>0x0&&_0x410cfb!=='Clockwise'&&(_0x24d3b3=0x168-_0x24d3b3);_0x24d3b3=Math['abs'](_0x24d3b3);}const _0x24e72f=_0x24d3b3/angularSpeed;_0x46dc7a['surroundDuration']=_0x24e72f/0x3,_0x46dc7a['stopPlayMode']=_0xdf5dfd['StopAround'];const _0x44b52a=_0x4ef17b['toRadians'](_0xc33d3a),_0x4083e1=_0x4ef17b['toRadians'](_0xc33d3a+_0x2a14fa*_0x24d3b3/0x3),_0x147649=_0x4ef17b['toRadians'](_0xc33d3a+_0x2a14fa*_0x24d3b3*0x2/0x3),_0x3d6432=_0x4ef17b['toRadians'](_0x5d892e),_0x43c89f=new _0x65a163({'point':point,'heading':_0x44b52a,'tilt':tilt,'stopName':stopName,'waitTime':waitTime,'speed':stopSpeed,'surroundDuration':_0x24e72f/0x3,'stopPlayMode':_0xdf5dfd['StopAround']});_0x43c89f['_bImmediately']=!![],_0x43c89f['_isGenerated']=!![],this['_addStop'](_0x43c89f);let _0x1f7a37=new _0x65a163({'point':point,'heading':_0x4083e1,'tilt':tilt,'stopName':stopName,'waitTime':0x0,'speed':stopSpeed,'surroundDuration':_0x24e72f/0x3,'stopPlayMode':_0xdf5dfd['StopAround']});_0x1f7a37['_isGenerated']=!![],this['_addStop'](_0x1f7a37);let _0x21b923=new _0x65a163({'point':point,'heading':_0x147649,'tilt':tilt,'stopName':stopName,'waitTime':0x0,'speed':stopSpeed,'surroundDuration':_0x24e72f/0x3,'stopPlayMode':_0xdf5dfd['StopAround']});_0x21b923['_isGenerated']=!![],this['_addStop'](_0x21b923);let _0xaef2c2=new _0x65a163({'point':point,'heading':_0x3d6432,'tilt':tilt,'stopName':stopName,'waitTime':waitTime,'speed':stopSpeed});this['_addStop'](_0xaef2c2),_0x5016ba+=_0x24e72f;}}}if(this['_isAlongline']){for(let _0x88db8f=0x0;_0x88db8f<this['stopCount']-0x1;_0x88db8f++){let _0x88fb83=this['stopCollection'][_0x88db8f];const _0xf445c7=this['stopCollection'][_0x88db8f+0x1],_0x1f2b1d=new _0x2429e4(_0xf445c7['point']['x']-_0x88fb83['point']['x'],_0xf445c7['point']['y']-_0x88fb83['point']['y'],_0xf445c7['point']['z']-_0x88fb83['point']['z']);_0x2429e4['normalize'](_0x1f2b1d,_0x1f2b1d),_0x88fb83['direction']=_0x1f2b1d,_0x88fb83['up']=_0x425237(_0x88fb83['point'],_0x1f2b1d),this['_isTiltFree']&&(_0x88fb83['heading']=_0x1bb65f['getHeading'](_0x88fb83['direction'],_0x88fb83['up'])-_0x4ef17b['PI']);}if(this['stopCount']>0x2){let _0x2466a8=this['stopCollection'][this['stopCollection']['length']-0x1];const _0x1f3125=this['stopCollection'][this['stopCollection']['length']-0x2];_0x2466a8['direction']=_0x1f3125['direction'],_0x2466a8['up']=_0x1f3125['up'],this['_isTiltFree']&&(_0x2466a8['heading']=_0x1bb65f['getHeading'](_0x2466a8['direction'],_0x2466a8['up'])-_0x4ef17b['PI']);}}_0x204171['length']>=0x2&&(this['_catmullRomSpline']=new Cesium['CatmullRomSpline']({'times':_0x46985e,'points':_0x204171})),this['setStopVisible'](),this['_totalDuration']=_0x5016ba;},_0x431413['prototype']['_addStop']=function(_0x264b8c){if(!_0x264b8c)throw new _0x4cd1f7('parameter\x20stop\x20is\x20required!');if(!(_0x264b8c instanceof _0x65a163))throw new _0x4cd1f7('parameter\x20stop\x20must\x20be\x20instanceof\x20RouteStop!');this['_stopCollection']['set'](_0x264b8c['index'],_0x264b8c);if(_0x3748fb(this['_entityCollection'])&&this['_isStopVisible']){const _0x5984a0=this['_entityCollection']['add']({'position':_0x264b8c['point'],'billboard':{'image':_0xc7ea4('Assets/Textures/grepin.png'),'scale':0.5}});this['_stopMarkCollection']['push'](_0x5984a0);}if(this['_isCleared']&&this['_stopCollection']['length']>0x2){if(_0x3748fb(this['_catmullRomSpline'])){const _0x3f4b96=[]['concat'](this['_catmullRomSpline']['times']);let _0x31ec75=[]['concat'](this['_catmullRomSpline']['points']),_0x27feae=this['_stopCollection']['length']>0x0?this['_stopCollection']['_array'][this['_stopCollection']['length']-0x2]['_duration']:0x0,_0x200ee2=_0x3f4b96['length']>0x0?_0x3f4b96[_0x3f4b96['length']-0x1]:0x0;_0x3f4b96['push'](_0x200ee2+_0x27feae),_0x31ec75['push'](_0x264b8c['point']),this['_catmullRomSpline']=new Cesium['CatmullRomSpline']({'times':_0x3f4b96,'points':_0x31ec75});}else{let _0x312070=[0x0],_0x29554f=[this['_stopCollection']['_array'][0x0]['point']],_0x5c3f7b=0x0;for(let _0x3f66a9=0x1;_0x3f66a9<this['_stopCollection']['length'];_0x3f66a9++){let _0x8e670a=this['_stopCollection']['_array'][_0x3f66a9],_0xc1474f=this['_stopCollection']['_array'][_0x3f66a9-0x1];_0x29554f['push'](_0x8e670a['point']),_0x5c3f7b+=_0xc1474f['duration'],_0x312070['push'](_0x5c3f7b);}this['_catmullRomSpline']=new CatmullRomSpline({'times':_0x312070,'points':_0x29554f});}}return!![];},_0x431413['prototype']['addStop']=function(_0x383168){if(!_0x383168)throw new _0x4cd1f7('parameter\x20stop\x20is\x20required!');if(!(_0x383168 instanceof _0x65a163))throw new _0x4cd1f7('parameter\x20stop\x20must\x20be\x20instanceof\x20RouteStop!');_0x383168['_preStopIndex']=this['_stopsInfo']['stopNodes']['length']+this['_addedStops']['length']-0x1,_0x383168['_index']=_0x383168['_preStopIndex']+0x1,this['_addedStops']['push'](_0x383168),this['clear'](),this['init'](),this['setLineVisible']();},_0x431413['prototype']['removeStop']=function(_0x40b321){this['clear'](),this['_removeIndex']['indexOf'](_0x40b321['index'])===-0x1&&this['_removeIndex']['push'](_0x40b321['index']),this['init'](),this['setLineVisible']();},_0x431413['prototype']['setLineVisible']=function(){if(!_0x3748fb(this['_entityCollection']))return;if(!_0x3748fb(this['_lineEntity'])){let _0x56f638=this['stopCollection'],_0x94d559=_0x56f638['length'],_0x5a3b31=[];while(_0x94d559--){_0x5a3b31['push'](_0x56f638[_0x94d559]['point']);}this['_lineEntity']=this['_entityCollection']['add']({'name':this['routeName'],'polyline':{'positions':_0x5a3b31,'width':0x5}});}this['_lineEntity']['show']=this['_isLineVisible'];},_0x431413['prototype']['setStopVisible']=function(){if(!_0x3748fb(this['_entityCollection']))return;if(this['_stopMarkCollection']['length']===0x0&&this['_isStopVisible']){const _0x9a30e5=this['stopCollection'];let _0x211a42=_0x9a30e5['length'];while(_0x211a42--){const _0x4b7d15=_0x9a30e5[_0x211a42];let _0x11ab8f=this['_entityCollection']['add']({'position':_0x4b7d15['point'],'billboard':{'image':_0xc7ea4('Assets/Textures/grepin.png'),'scale':0.5}});this['_stopMarkCollection']['push'](_0x11ab8f);}}for(let _0x349172=0x0,_0x3e1d78=this['_stopMarkCollection']['length'];_0x349172<_0x3e1d78;_0x349172++){let _0x4d5fa8=this['_stopMarkCollection'][_0x349172];_0x4d5fa8['show']=this['_isStopVisible'];}},_0x431413['prototype']['get']=function(_0x45217f){return this['_stopCollection']['get'](_0x45217f)===undefined?this['stopCollection'][_0x45217f]:this['_stopCollection']['get'](_0x45217f);},_0x431413['prototype']['clear']=function(){this['_isCleared']=!![];for(let _0x2b3d63=0x0;_0x2b3d63<this['_stopMarkCollection']['length'];_0x2b3d63++){this['_entityCollection']['remove'](this['_stopMarkCollection'][_0x2b3d63]);}_0x3748fb(this['_lineEntity'])&&(this['_entityCollection']['remove'](this['_lineEntity']),this['_lineEntity']=undefined),this['_stopCollection']['removeAll'](),_0x3748fb(this['_catmullRomSpline'])&&(this['_catmullRomSpline']=undefined);};export default _0x431413;