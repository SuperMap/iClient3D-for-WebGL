const _0x22e014=(function(){let _0x5d6322=!![];return function(_0x4963a6,_0x4dec65){const _0x34dd78=_0x5d6322?function(){if(_0x4dec65){const _0x18957c=_0x4dec65['apply'](_0x4963a6,arguments);return _0x4dec65=null,_0x18957c;}}:function(){};return _0x5d6322=![],_0x34dd78;};}()),_0x162715=_0x22e014(this,function(){return _0x162715['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](_0x162715)['search']('(((.+)+)+)+$');});_0x162715();import _0x45cf89 from'./RouteStop.js';import _0x3e1d60 from'../Ext/buildModuleUrl.js';import _0x81cff2 from'../Ext/XmlParser.js';import _0x860f from'./StopPlayMode.js';import _0x3787ba from'../Mixin/Common.js';const _0x414e94=Cesium['DeveloperError'],_0xde686f=Cesium['Cartesian3'],_0x4e0cf1=Cesium['defaultValue'],_0x4b6ada=Cesium['defined'],_0x4c2725=Cesium['Math'],_0x3195f4=Cesium['Transforms'],_0x139373=Cesium['AssociativeArray'];function _0x1114ad(_0x41bdf9){_0x41bdf9=_0x41bdf9||{},this['_stopCollection']=new _0x139373(),this['_isStopVisible']=_0x4e0cf1(_0x41bdf9['isStopVisible'],![]),this['_stopMarkCollection']=[],this['_isFlyLoop']=_0x4e0cf1(_0x41bdf9['isFlyLoop'],![]),this['_isLineVisible']=_0x4e0cf1(_0x41bdf9['isLineVisible'],![]),this['_lineEntity']=undefined,this['_routeName']=_0x4e0cf1(_0x41bdf9['routeName'],''),this['_speed']=_0x4e0cf1(_0x41bdf9['speed'],0x32),this['_isAlongline']=_0x4e0cf1(_0x41bdf9['isAlongline'],![]),this['_totalDuration']=_0x4e0cf1(_0x41bdf9['totalDuration'],0x0),this['_isHeadingFree']=!this['_isAlongline']&&_0x4e0cf1(_0x41bdf9['isHeadingFree'],![]),this['_isTiltFree']=_0x4e0cf1(_0x41bdf9['isTiltFree'],![]),this['_isAltitudeFree']=_0x4e0cf1(_0x41bdf9['isAltitudeFree'],![]),this['_entityCollection']=_0x41bdf9['entityCollection'],this['_catmullRomSpline']=undefined,this['_isCleared']=![],this['_stopsInfo']=_0x4e0cf1(_0x41bdf9['stopsInfo'],{}),this['_removeIndex']=[],this['_addedStops']=[];}Object['defineProperties'](_0x1114ad['prototype'],{'stopCollection':{'get':function(){return this['_stopCollection']['values'];}},'isStopVisible':{'get':function(){return this['_isStopVisible'];},'set':function(_0x5a8d53){_0x4b6ada(_0x5a8d53)&&_0x5a8d53!==this['_isStopVisible']&&(this['_isStopVisible']=_0x5a8d53,this['setStopVisible']());}},'isFlyLoop':{'get':function(){return this['_isFlyLoop'];},'set':function(_0x2b3520){_0x2b3520&&(this['_isFlyLoop']=_0x2b3520);}},'isLineVisible':{'get':function(){return this['_isLineVisible'];},'set':function(_0x48fae0){_0x4b6ada(_0x48fae0)&&_0x48fae0!==this['_isLineVisible']&&(this['_isLineVisible']=_0x48fae0,this['setLineVisible']());}},'lineEntity':{'get':function(){return this['_lineEntity'];},'set':function(_0x3b2657){_0x4b6ada(_0x3b2657)&&(this['_lineEntity']=_0x3b2657);}},'routeName':{'get':function(){return this['_routeName'];},'set':function(_0x36385e){_0x36385e&&(this['_routeName']=_0x36385e);}},'speed':{'get':function(){return this['_speed'];},'set':function(_0x234d50){if(_0x234d50&&_0x234d50!=this['_speed']){this['_speed']=_0x234d50;let _0x27571f=this['speed'],_0x46582f=this['stopCollection'];for(let _0x5a1f2f=0x0,_0x367139=_0x46582f['length'];_0x5a1f2f<_0x367139-0x1;_0x5a1f2f++){let _0x438f91=_0x46582f[_0x5a1f2f];_0x438f91['duration']=Math['ceil'](_0x438f91['distanceToNext']/_0x27571f);}}}},'stopCount':{'get':function(){return this['_stopCollection']['length'];}},'isAlongline':{'get':function(){return this['_isAlongline'];},'set':function(_0x347eba){_0x4b6ada(_0x347eba)&&(this['_isAlongline']=_0x347eba);}},'totalDuration':{'get':function(){return this['_totalDuration'];}},'isHeadingFree':{'get':function(){return this['_isHeadingFree'];},'set':function(_0x1922d7){_0x4b6ada(_0x1922d7)&&(this['_isHeadingFree']=_0x1922d7);}},'isTiltFree':{'get':function(){return this['_isTiltFree'];},'set':function(_0x5db81c){_0x4b6ada(_0x5db81c)&&(this['_isTiltFree']=_0x5db81c);}},'isAltitudeFree':{'get':function(){return this['_isAltitudeFree'];},'set':function(_0x1224e3){_0x4b6ada(_0x1224e3)&&(this['_isAltitudeFree']=_0x1224e3);}}}),_0x1114ad['prototype']['init']=function(){let _0x377c3a=0x0,_0x3da558=[0x0],_0x2cccae=[],_0x32c68a=this['_stopsInfo']['stopNodes'];const _0x17a5a2=this['_stopsInfo']['namespace'];_0x4b6ada(_0x32c68a)?_0x32c68a=_0x32c68a['concat'](this['_addedStops']):_0x32c68a=this['_addedStops'];for(let _0x497613=0x0;_0x497613<_0x32c68a['length'];_0x497613++){if(this['_removeIndex']['indexOf'](_0x497613)>-0x1)continue;let _0x409154=_0x32c68a[_0x497613],_0x32d5b7,_0x500855,_0x2aa9a6;if(!(_0x409154 instanceof _0x45cf89)){let _0x5f0c82=_0x81cff2['queryFirstNode'](_0x409154,'camera',_0x17a5a2);const _0x36855d=_0x81cff2['queryNumericValue'](_0x5f0c82,'longitude',_0x17a5a2),_0x194b98=_0x81cff2['queryNumericValue'](_0x5f0c82,'latitude',_0x17a5a2),_0x3b0cce=_0x81cff2['queryNumericValue'](_0x5f0c82,'altitude',_0x17a5a2);let _0xdad44f=_0x81cff2['queryNumericValue'](_0x5f0c82,'heading',_0x17a5a2);_0xdad44f=_0x4c2725['toRadians'](_0xdad44f);let _0x1988be=_0x81cff2['queryNumericValue'](_0x5f0c82,'tilt',_0x17a5a2);_0x1988be=_0x4c2725['toRadians'](_0x1988be-0x5a);this['_isAlongline']&&!this['_isTiltFree']&&(_0x1988be=0x0);const _0x3a6d71=_0x81cff2['queryStringValue'](_0x5f0c82,'altitudeMode',_0x17a5a2),_0x1566ac=_0x81cff2['queryStringAttribute'](_0x409154,'name'),_0xcb7e05=_0x81cff2['queryNumericAttribute'](_0x409154,'speed',_0x17a5a2),_0x14d071=_0x81cff2['queryFirstNode'](_0x409154,'setting',_0x17a5a2);_0x2aa9a6=_0x81cff2['queryStringValue'](_0x14d071,'stopPlayMode',_0x17a5a2);const _0x5b42c6=_0x81cff2['queryNumericValue'](_0x14d071,'pauseTime',_0x17a5a2),_0x98043=_0x81cff2['queryNumericValue'](_0x14d071,'angularSpeed',_0x17a5a2),_0x16e68f=_0x81cff2['queryFirstNode'](_0x14d071,'stopViews',_0x17a5a2);let _0x53f688,_0x78ee4f=!![];_0x36855d>0xb4||_0x194b98>0xb4?(_0x53f688=new _0xde686f(_0x36855d,_0x194b98,_0x3b0cce),_0x78ee4f=![]):_0x53f688=_0xde686f['fromDegrees'](_0x36855d,_0x194b98,_0x3b0cce);_0x2cccae['push'](_0x53f688);let _0x3965c2=this['stopCount'];if(_0x497613>0x0&&_0x3965c2>0x0){_0x500855=this['_stopCollection']['_array'][this['_stopCollection']['length']-0x1];if(_0x500855['stopPlayMode']!=_0x860f['StopAround']){const _0x2a9204=_0x500855['point'],_0x208993=_0xde686f['distance'](_0x2a9204,_0x53f688);_0x500855['distanceToNext']=_0x208993;let _0x459af0=_0x500855['speed'],_0x56b82e;0x0<_0x459af0?_0x56b82e=_0x459af0:_0x56b82e=this['_speed'],_0x500855['duration']=_0x208993/_0x56b82e,_0x500855['speed']=_0x56b82e,_0x377c3a+=_0x500855['duration'],_0x3da558['push'](_0x377c3a);}}_0x32d5b7=new _0x45cf89({'index':_0x497613,'point':_0x53f688,'heading':_0xdad44f,'tilt':_0x1988be,'stopName':_0x1566ac,'waitTime':_0x5b42c6,'speed':_0xcb7e05,'isConvert':_0x78ee4f}),_0x32d5b7['altitude']=_0x3b0cce;}else _0x32d5b7=_0x409154;this['_addStop'](_0x32d5b7);_0x4b6ada(_0x500855)&&(_0x500855['_nextStopIndex']=_0x497613,_0x32d5b7['_preStopIndex']=_0x500855['index']);if(_0x2aa9a6===_0x860f['StopAround']&&stopsViesNode){const _0x44b1b3=queryChildNodes(stopsViesNode,'view',_0x17a5a2);if(_0x44b1b3['length']==0x2){const _0x5c6ff3=_0x44b1b3[0x0],_0x250b35=_0x44b1b3[0x1],_0x2c7557=_0x81cff2['queryNumericAttribute'](_0x5c6ff3,'heading',_0x17a5a2),_0x3894f5=_0x81cff2['queryNumericAttribute'](_0x250b35,'heading',_0x17a5a2),_0x368fb5=_0x81cff2['queryNumericAttribute'](_0x5c6ff3,'tilt',_0x17a5a2),_0x2d5ea3=_0x81cff2['queryNumericAttribute'](_0x250b35,'tilt',_0x17a5a2),_0x1d1936=_0x81cff2['queryNumericAttribute'](_0x5c6ff3,'altitude',_0x17a5a2),_0x2b7c53=_0x81cff2['queryNumericAttribute'](_0x250b35,'altitude',_0x17a5a2),_0x3529af=_0x81cff2['queryStringAttribute'](_0x5c6ff3,'direction',_0x17a5a2),_0x7fbdd0=_0x81cff2['queryStringAttribute'](_0x250b35,'direction',_0x17a5a2);let _0x4b1507,_0x19ebf0=_0x3529af==='Clockwise'?0x1:-0x1;if(_0x4c2725['equalsEpsilon'](_0x2c7557,_0x3894f5,_0x4c2725['EPSILON15']))_0x4b1507=0x168;else{_0x4b1507=_0x3894f5-_0x2c7557;if(_0x4b1507<0x0&&_0x3529af==='Clockwise')_0x4b1507+=0x168;else _0x4b1507>0x0&&_0x3529af!=='Clockwise'&&(_0x4b1507=0x168-_0x4b1507);_0x4b1507=Math['abs'](_0x4b1507);}const _0x43aaaa=_0x4b1507/angularSpeed;_0x32d5b7['surroundDuration']=_0x43aaaa/0x3,_0x32d5b7['stopPlayMode']=_0x860f['StopAround'];const _0x4ba22b=_0x4c2725['toRadians'](_0x2c7557),_0x2434e7=_0x4c2725['toRadians'](_0x2c7557+_0x19ebf0*_0x4b1507/0x3),_0x339afc=_0x4c2725['toRadians'](_0x2c7557+_0x19ebf0*_0x4b1507*0x2/0x3),_0x454886=_0x4c2725['toRadians'](_0x3894f5),_0xe75f7d=new _0x45cf89({'point':point,'heading':_0x4ba22b,'tilt':tilt,'stopName':stopName,'waitTime':waitTime,'speed':stopSpeed,'surroundDuration':_0x43aaaa/0x3,'stopPlayMode':_0x860f['StopAround']});_0xe75f7d['_bImmediately']=!![],_0xe75f7d['_isGenerated']=!![],this['_addStop'](_0xe75f7d);let _0x22d220=new _0x45cf89({'point':point,'heading':_0x2434e7,'tilt':tilt,'stopName':stopName,'waitTime':0x0,'speed':stopSpeed,'surroundDuration':_0x43aaaa/0x3,'stopPlayMode':_0x860f['StopAround']});_0x22d220['_isGenerated']=!![],this['_addStop'](_0x22d220);let _0x5a353a=new _0x45cf89({'point':point,'heading':_0x339afc,'tilt':tilt,'stopName':stopName,'waitTime':0x0,'speed':stopSpeed,'surroundDuration':_0x43aaaa/0x3,'stopPlayMode':_0x860f['StopAround']});_0x5a353a['_isGenerated']=!![],this['_addStop'](_0x5a353a);let _0x2ee4a0=new _0x45cf89({'point':point,'heading':_0x454886,'tilt':tilt,'stopName':stopName,'waitTime':waitTime,'speed':stopSpeed});this['_addStop'](_0x2ee4a0),_0x377c3a+=_0x43aaaa;}}}if(this['_isAlongline']){for(let _0x48ae10=0x0;_0x48ae10<this['stopCount']-0x1;_0x48ae10++){let _0x36a4a2=this['stopCollection'][_0x48ae10];const _0x124ec9=this['stopCollection'][_0x48ae10+0x1],_0x403a63=new _0xde686f(_0x124ec9['point']['x']-_0x36a4a2['point']['x'],_0x124ec9['point']['y']-_0x36a4a2['point']['y'],_0x124ec9['point']['z']-_0x36a4a2['point']['z']);_0xde686f['normalize'](_0x403a63,_0x403a63),_0x36a4a2['direction']=_0x403a63,_0x36a4a2['up']=_0x3787ba(_0x36a4a2['point'],_0x403a63),this['_isTiltFree']&&(_0x36a4a2['heading']=_0x3195f4['getHeading'](_0x36a4a2['direction'],_0x36a4a2['up'])-_0x4c2725['PI']);}if(this['stopCount']>0x2){let _0xe8b2dd=this['stopCollection'][this['stopCollection']['length']-0x1];const _0x4366f5=this['stopCollection'][this['stopCollection']['length']-0x2];_0xe8b2dd['direction']=_0x4366f5['direction'],_0xe8b2dd['up']=_0x4366f5['up'],this['_isTiltFree']&&(_0xe8b2dd['heading']=_0x3195f4['getHeading'](_0xe8b2dd['direction'],_0xe8b2dd['up'])-_0x4c2725['PI']);}}_0x2cccae['length']>=0x2&&(this['_catmullRomSpline']=new Cesium['CatmullRomSpline']({'times':_0x3da558,'points':_0x2cccae})),this['setStopVisible'](),this['_totalDuration']=_0x377c3a;},_0x1114ad['prototype']['_addStop']=function(_0x1d05b5){if(!_0x1d05b5)throw new _0x414e94('parameter\x20stop\x20is\x20required!');if(!(_0x1d05b5 instanceof _0x45cf89))throw new _0x414e94('parameter\x20stop\x20must\x20be\x20instanceof\x20RouteStop!');this['_stopCollection']['set'](_0x1d05b5['index'],_0x1d05b5);if(_0x4b6ada(this['_entityCollection'])&&this['_isStopVisible']){const _0x4cd7f3=this['_entityCollection']['add']({'position':_0x1d05b5['point'],'billboard':{'image':_0x3e1d60('Assets/Textures/grepin.png'),'scale':0.5}});this['_stopMarkCollection']['push'](_0x4cd7f3);}if(this['_isCleared']&&this['_stopCollection']['length']>0x2){if(_0x4b6ada(this['_catmullRomSpline'])){const _0x2e9b1c=[]['concat'](this['_catmullRomSpline']['times']);let _0x3689e=[]['concat'](this['_catmullRomSpline']['points']),_0x5d8f9d=this['_stopCollection']['length']>0x0?this['_stopCollection']['_array'][this['_stopCollection']['length']-0x2]['_duration']:0x0,_0x372025=_0x2e9b1c['length']>0x0?_0x2e9b1c[_0x2e9b1c['length']-0x1]:0x0;_0x2e9b1c['push'](_0x372025+_0x5d8f9d),_0x3689e['push'](_0x1d05b5['point']),this['_catmullRomSpline']=new Cesium['CatmullRomSpline']({'times':_0x2e9b1c,'points':_0x3689e});}else{let _0x4a827e=[0x0],_0xe828f2=[this['_stopCollection']['_array'][0x0]['point']],_0x696755=0x0;for(let _0x28c49f=0x1;_0x28c49f<this['_stopCollection']['length'];_0x28c49f++){let _0x4ea9f5=this['_stopCollection']['_array'][_0x28c49f],_0x3f5b9e=this['_stopCollection']['_array'][_0x28c49f-0x1];_0xe828f2['push'](_0x4ea9f5['point']),_0x696755+=_0x3f5b9e['duration'],_0x4a827e['push'](_0x696755);}this['_catmullRomSpline']=new CatmullRomSpline({'times':_0x4a827e,'points':_0xe828f2});}}return!![];},_0x1114ad['prototype']['addStop']=function(_0x1ead2d){if(!_0x1ead2d)throw new _0x414e94('parameter\x20stop\x20is\x20required!');if(!(_0x1ead2d instanceof _0x45cf89))throw new _0x414e94('parameter\x20stop\x20must\x20be\x20instanceof\x20RouteStop!');_0x1ead2d['_preStopIndex']=this['_stopsInfo']['stopNodes']['length']+this['_addedStops']['length']-0x1,_0x1ead2d['_index']=_0x1ead2d['_preStopIndex']+0x1,this['_addedStops']['push'](_0x1ead2d),this['clear'](),this['init'](),this['setLineVisible']();},_0x1114ad['prototype']['removeStop']=function(_0x27432e){this['clear'](),this['_removeIndex']['indexOf'](_0x27432e['index'])===-0x1&&this['_removeIndex']['push'](_0x27432e['index']),this['init'](),this['setLineVisible']();},_0x1114ad['prototype']['setLineVisible']=function(){if(!_0x4b6ada(this['_entityCollection']))return;if(!_0x4b6ada(this['_lineEntity'])){let _0x34d716=this['stopCollection'],_0x4a16af=_0x34d716['length'],_0x4dc728=[];while(_0x4a16af--){_0x4dc728['push'](_0x34d716[_0x4a16af]['point']);}this['_lineEntity']=this['_entityCollection']['add']({'name':this['routeName'],'polyline':{'positions':_0x4dc728,'width':0x5}});}this['_lineEntity']['show']=this['_isLineVisible'];},_0x1114ad['prototype']['setStopVisible']=function(){if(!_0x4b6ada(this['_entityCollection']))return;if(this['_stopMarkCollection']['length']===0x0&&this['_isStopVisible']){const _0x4d4c57=this['stopCollection'];let _0x36c308=_0x4d4c57['length'];while(_0x36c308--){const _0x2763d9=_0x4d4c57[_0x36c308];let _0x1c1026=this['_entityCollection']['add']({'position':_0x2763d9['point'],'billboard':{'image':_0x3e1d60('Assets/Textures/grepin.png'),'scale':0.5}});this['_stopMarkCollection']['push'](_0x1c1026);}}for(let _0x5e386f=0x0,_0x5bcdac=this['_stopMarkCollection']['length'];_0x5e386f<_0x5bcdac;_0x5e386f++){let _0x17ff9a=this['_stopMarkCollection'][_0x5e386f];_0x17ff9a['show']=this['_isStopVisible'];}},_0x1114ad['prototype']['get']=function(_0x1d6cd9){return this['_stopCollection']['get'](_0x1d6cd9)===undefined?this['stopCollection'][_0x1d6cd9]:this['_stopCollection']['get'](_0x1d6cd9);},_0x1114ad['prototype']['clear']=function(){this['_isCleared']=!![];for(let _0x37dadd=0x0;_0x37dadd<this['_stopMarkCollection']['length'];_0x37dadd++){this['_entityCollection']['remove'](this['_stopMarkCollection'][_0x37dadd]);}_0x4b6ada(this['_lineEntity'])&&(this['_entityCollection']['remove'](this['_lineEntity']),this['_lineEntity']=undefined),this['_stopCollection']['removeAll'](),_0x4b6ada(this['_catmullRomSpline'])&&(this['_catmullRomSpline']=undefined);};export default _0x1114ad;