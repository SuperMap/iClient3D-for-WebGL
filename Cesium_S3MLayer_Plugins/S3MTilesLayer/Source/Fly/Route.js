const _0x3aaf73=(function(){let _0x866b3a=!![];return function(_0x41ac5c,_0x9915b2){const _0x21895c=_0x866b3a?function(){if(_0x9915b2){const _0x1c26ff=_0x9915b2['apply'](_0x41ac5c,arguments);return _0x9915b2=null,_0x1c26ff;}}:function(){};return _0x866b3a=![],_0x21895c;};}()),_0x550ac2=_0x3aaf73(this,function(){return _0x550ac2['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](_0x550ac2)['search']('(((.+)+)+)+$');});_0x550ac2();import _0x3caea6 from'./RouteStop.js';import _0x2cbcd7 from'../Ext/buildModuleUrl.js';import _0x518f90 from'../Ext/XmlParser.js';import _0x1ec931 from'./StopPlayMode.js';import _0x5877cb from'../Mixin/Common.js';const _0x3d1adc=Cesium['DeveloperError'],_0x809dc1=Cesium['Cartesian3'],_0x7848d1=Cesium['defaultValue'],_0x46fc97=Cesium['defined'],_0x3e12d6=Cesium['Math'],_0x3a8170=Cesium['Transforms'],_0x1dbb93=Cesium['AssociativeArray'];function _0x44dd8a(_0x1db41d){_0x1db41d=_0x1db41d||{},this['_stopCollection']=new _0x1dbb93(),this['_isStopVisible']=_0x7848d1(_0x1db41d['isStopVisible'],![]),this['_stopMarkCollection']=[],this['_isFlyLoop']=_0x7848d1(_0x1db41d['isFlyLoop'],![]),this['_isLineVisible']=_0x7848d1(_0x1db41d['isLineVisible'],![]),this['_lineEntity']=undefined,this['_routeName']=_0x7848d1(_0x1db41d['routeName'],''),this['_speed']=_0x7848d1(_0x1db41d['speed'],0x32),this['_isAlongline']=_0x7848d1(_0x1db41d['isAlongline'],![]),this['_totalDuration']=_0x7848d1(_0x1db41d['totalDuration'],0x0),this['_isHeadingFree']=!this['_isAlongline']&&_0x7848d1(_0x1db41d['isHeadingFree'],![]),this['_isTiltFree']=_0x7848d1(_0x1db41d['isTiltFree'],![]),this['_isAltitudeFree']=_0x7848d1(_0x1db41d['isAltitudeFree'],![]),this['_entityCollection']=_0x1db41d['entityCollection'],this['_catmullRomSpline']=undefined,this['_isCleared']=![],this['_stopsInfo']=_0x7848d1(_0x1db41d['stopsInfo'],{}),this['_removeIndex']=[],this['_addedStops']=[];}Object['defineProperties'](_0x44dd8a['prototype'],{'stopCollection':{'get':function(){return this['_stopCollection']['values'];}},'isStopVisible':{'get':function(){return this['_isStopVisible'];},'set':function(_0x3f0907){_0x46fc97(_0x3f0907)&&_0x3f0907!==this['_isStopVisible']&&(this['_isStopVisible']=_0x3f0907,this['setStopVisible']());}},'isFlyLoop':{'get':function(){return this['_isFlyLoop'];},'set':function(_0xb17028){_0xb17028&&(this['_isFlyLoop']=_0xb17028);}},'isLineVisible':{'get':function(){return this['_isLineVisible'];},'set':function(_0x3dffe4){_0x46fc97(_0x3dffe4)&&_0x3dffe4!==this['_isLineVisible']&&(this['_isLineVisible']=_0x3dffe4,this['setLineVisible']());}},'lineEntity':{'get':function(){return this['_lineEntity'];},'set':function(_0x51f69d){_0x46fc97(_0x51f69d)&&(this['_lineEntity']=_0x51f69d);}},'routeName':{'get':function(){return this['_routeName'];},'set':function(_0x5622ec){_0x5622ec&&(this['_routeName']=_0x5622ec);}},'speed':{'get':function(){return this['_speed'];},'set':function(_0x59ad0e){if(_0x59ad0e&&_0x59ad0e!=this['_speed']){this['_speed']=_0x59ad0e;let _0x5f120e=this['speed'],_0x23c800=this['stopCollection'];for(let _0xe7a284=0x0,_0x89d3f7=_0x23c800['length'];_0xe7a284<_0x89d3f7-0x1;_0xe7a284++){let _0x5cac86=_0x23c800[_0xe7a284];_0x5cac86['duration']=Math['ceil'](_0x5cac86['distanceToNext']/_0x5f120e);}}}},'stopCount':{'get':function(){return this['_stopCollection']['length'];}},'isAlongline':{'get':function(){return this['_isAlongline'];},'set':function(_0x14d8a4){_0x46fc97(_0x14d8a4)&&(this['_isAlongline']=_0x14d8a4);}},'totalDuration':{'get':function(){return this['_totalDuration'];}},'isHeadingFree':{'get':function(){return this['_isHeadingFree'];},'set':function(_0x1914c2){_0x46fc97(_0x1914c2)&&(this['_isHeadingFree']=_0x1914c2);}},'isTiltFree':{'get':function(){return this['_isTiltFree'];},'set':function(_0x3381b1){_0x46fc97(_0x3381b1)&&(this['_isTiltFree']=_0x3381b1);}},'isAltitudeFree':{'get':function(){return this['_isAltitudeFree'];},'set':function(_0x3963a9){_0x46fc97(_0x3963a9)&&(this['_isAltitudeFree']=_0x3963a9);}}}),_0x44dd8a['prototype']['init']=function(){let _0x23e5e2=0x0,_0x33148b=[0x0],_0x4cffdb=[],_0x40d008=this['_stopsInfo']['stopNodes'];const _0x4782c8=this['_stopsInfo']['namespace'];_0x46fc97(_0x40d008)?_0x40d008=_0x40d008['concat'](this['_addedStops']):_0x40d008=this['_addedStops'];for(let _0x28b455=0x0;_0x28b455<_0x40d008['length'];_0x28b455++){if(this['_removeIndex']['indexOf'](_0x28b455)>-0x1)continue;let _0x13d27f=_0x40d008[_0x28b455],_0x242bb1,_0xd4c0d0,_0xa4741b;if(!(_0x13d27f instanceof _0x3caea6)){let _0x23c710=_0x518f90['queryFirstNode'](_0x13d27f,'camera',_0x4782c8);const _0x356a9f=_0x518f90['queryNumericValue'](_0x23c710,'longitude',_0x4782c8),_0x14a8c0=_0x518f90['queryNumericValue'](_0x23c710,'latitude',_0x4782c8),_0x5197bf=_0x518f90['queryNumericValue'](_0x23c710,'altitude',_0x4782c8);let _0x1bf311=_0x518f90['queryNumericValue'](_0x23c710,'heading',_0x4782c8);_0x1bf311=_0x3e12d6['toRadians'](_0x1bf311);let _0x50d3=_0x518f90['queryNumericValue'](_0x23c710,'tilt',_0x4782c8);_0x50d3=_0x3e12d6['toRadians'](_0x50d3-0x5a);this['_isAlongline']&&!this['_isTiltFree']&&(_0x50d3=0x0);const _0x39730a=_0x518f90['queryStringValue'](_0x23c710,'altitudeMode',_0x4782c8),_0x5b72e2=_0x518f90['queryStringAttribute'](_0x13d27f,'name'),_0x54305e=_0x518f90['queryNumericAttribute'](_0x13d27f,'speed',_0x4782c8),_0x412b19=_0x518f90['queryFirstNode'](_0x13d27f,'setting',_0x4782c8);_0xa4741b=_0x518f90['queryStringValue'](_0x412b19,'stopPlayMode',_0x4782c8);const _0x6a9849=_0x518f90['queryNumericValue'](_0x412b19,'pauseTime',_0x4782c8),_0x551c5e=_0x518f90['queryNumericValue'](_0x412b19,'angularSpeed',_0x4782c8),_0x32dd50=_0x518f90['queryFirstNode'](_0x412b19,'stopViews',_0x4782c8);let _0x5eca92,_0x2f402b=!![];_0x356a9f>0xb4||_0x14a8c0>0xb4?(_0x5eca92=new _0x809dc1(_0x356a9f,_0x14a8c0,_0x5197bf),_0x2f402b=![]):_0x5eca92=_0x809dc1['fromDegrees'](_0x356a9f,_0x14a8c0,_0x5197bf);_0x4cffdb['push'](_0x5eca92);let _0x3d508c=this['stopCount'];if(_0x28b455>0x0&&_0x3d508c>0x0){_0xd4c0d0=this['_stopCollection']['_array'][this['_stopCollection']['length']-0x1];if(_0xd4c0d0['stopPlayMode']!=_0x1ec931['StopAround']){const _0x2cc748=_0xd4c0d0['point'],_0x2f0b4b=_0x809dc1['distance'](_0x2cc748,_0x5eca92);_0xd4c0d0['distanceToNext']=_0x2f0b4b;let _0x470581=_0xd4c0d0['speed'],_0x34677c;0x0<_0x470581?_0x34677c=_0x470581:_0x34677c=this['_speed'],_0xd4c0d0['duration']=_0x2f0b4b/_0x34677c,_0xd4c0d0['speed']=_0x34677c,_0x23e5e2+=_0xd4c0d0['duration'],_0x33148b['push'](_0x23e5e2);}}_0x242bb1=new _0x3caea6({'index':_0x28b455,'point':_0x5eca92,'heading':_0x1bf311,'tilt':_0x50d3,'stopName':_0x5b72e2,'waitTime':_0x6a9849,'speed':_0x54305e,'isConvert':_0x2f402b}),_0x242bb1['altitude']=_0x5197bf;}else _0x242bb1=_0x13d27f;this['_addStop'](_0x242bb1);_0x46fc97(_0xd4c0d0)&&(_0xd4c0d0['_nextStopIndex']=_0x28b455,_0x242bb1['_preStopIndex']=_0xd4c0d0['index']);if(_0xa4741b===_0x1ec931['StopAround']&&stopsViesNode){const _0x2d7e75=queryChildNodes(stopsViesNode,'view',_0x4782c8);if(_0x2d7e75['length']==0x2){const _0x684764=_0x2d7e75[0x0],_0x1f9028=_0x2d7e75[0x1],_0x5e28df=_0x518f90['queryNumericAttribute'](_0x684764,'heading',_0x4782c8),_0x583ece=_0x518f90['queryNumericAttribute'](_0x1f9028,'heading',_0x4782c8),_0x1975bf=_0x518f90['queryNumericAttribute'](_0x684764,'tilt',_0x4782c8),_0x315f72=_0x518f90['queryNumericAttribute'](_0x1f9028,'tilt',_0x4782c8),_0x42248e=_0x518f90['queryNumericAttribute'](_0x684764,'altitude',_0x4782c8),_0x134cbe=_0x518f90['queryNumericAttribute'](_0x1f9028,'altitude',_0x4782c8),_0x4903a1=_0x518f90['queryStringAttribute'](_0x684764,'direction',_0x4782c8),_0x554a67=_0x518f90['queryStringAttribute'](_0x1f9028,'direction',_0x4782c8);let _0x360e9c,_0x4b7b86=_0x4903a1==='Clockwise'?0x1:-0x1;if(_0x3e12d6['equalsEpsilon'](_0x5e28df,_0x583ece,_0x3e12d6['EPSILON15']))_0x360e9c=0x168;else{_0x360e9c=_0x583ece-_0x5e28df;if(_0x360e9c<0x0&&_0x4903a1==='Clockwise')_0x360e9c+=0x168;else _0x360e9c>0x0&&_0x4903a1!=='Clockwise'&&(_0x360e9c=0x168-_0x360e9c);_0x360e9c=Math['abs'](_0x360e9c);}const _0x1f3732=_0x360e9c/angularSpeed;_0x242bb1['surroundDuration']=_0x1f3732/0x3,_0x242bb1['stopPlayMode']=_0x1ec931['StopAround'];const _0x2baf13=_0x3e12d6['toRadians'](_0x5e28df),_0x2c9ee1=_0x3e12d6['toRadians'](_0x5e28df+_0x4b7b86*_0x360e9c/0x3),_0x2aabd2=_0x3e12d6['toRadians'](_0x5e28df+_0x4b7b86*_0x360e9c*0x2/0x3),_0x2d071d=_0x3e12d6['toRadians'](_0x583ece),_0x3310ca=new _0x3caea6({'point':point,'heading':_0x2baf13,'tilt':tilt,'stopName':stopName,'waitTime':waitTime,'speed':stopSpeed,'surroundDuration':_0x1f3732/0x3,'stopPlayMode':_0x1ec931['StopAround']});_0x3310ca['_bImmediately']=!![],_0x3310ca['_isGenerated']=!![],this['_addStop'](_0x3310ca);let _0x45cd7f=new _0x3caea6({'point':point,'heading':_0x2c9ee1,'tilt':tilt,'stopName':stopName,'waitTime':0x0,'speed':stopSpeed,'surroundDuration':_0x1f3732/0x3,'stopPlayMode':_0x1ec931['StopAround']});_0x45cd7f['_isGenerated']=!![],this['_addStop'](_0x45cd7f);let _0x30f93d=new _0x3caea6({'point':point,'heading':_0x2aabd2,'tilt':tilt,'stopName':stopName,'waitTime':0x0,'speed':stopSpeed,'surroundDuration':_0x1f3732/0x3,'stopPlayMode':_0x1ec931['StopAround']});_0x30f93d['_isGenerated']=!![],this['_addStop'](_0x30f93d);let _0x220cf6=new _0x3caea6({'point':point,'heading':_0x2d071d,'tilt':tilt,'stopName':stopName,'waitTime':waitTime,'speed':stopSpeed});this['_addStop'](_0x220cf6),_0x23e5e2+=_0x1f3732;}}}if(this['_isAlongline']){for(let _0x1432f4=0x0;_0x1432f4<this['stopCount']-0x1;_0x1432f4++){let _0x294170=this['stopCollection'][_0x1432f4];const _0x1d65c1=this['stopCollection'][_0x1432f4+0x1],_0x515991=new _0x809dc1(_0x1d65c1['point']['x']-_0x294170['point']['x'],_0x1d65c1['point']['y']-_0x294170['point']['y'],_0x1d65c1['point']['z']-_0x294170['point']['z']);_0x809dc1['normalize'](_0x515991,_0x515991),_0x294170['direction']=_0x515991,_0x294170['up']=_0x5877cb(_0x294170['point'],_0x515991),this['_isTiltFree']&&(_0x294170['heading']=_0x3a8170['getHeading'](_0x294170['direction'],_0x294170['up'])-_0x3e12d6['PI']);}if(this['stopCount']>0x2){let _0x9ebb7b=this['stopCollection'][this['stopCollection']['length']-0x1];const _0x1b83b0=this['stopCollection'][this['stopCollection']['length']-0x2];_0x9ebb7b['direction']=_0x1b83b0['direction'],_0x9ebb7b['up']=_0x1b83b0['up'],this['_isTiltFree']&&(_0x9ebb7b['heading']=_0x3a8170['getHeading'](_0x9ebb7b['direction'],_0x9ebb7b['up'])-_0x3e12d6['PI']);}}_0x4cffdb['length']>=0x2&&(this['_catmullRomSpline']=new Cesium['CatmullRomSpline']({'times':_0x33148b,'points':_0x4cffdb})),this['setStopVisible'](),this['_totalDuration']=_0x23e5e2;},_0x44dd8a['prototype']['_addStop']=function(_0x5a4bb8){if(!_0x5a4bb8)throw new _0x3d1adc('parameter\x20stop\x20is\x20required!');if(!(_0x5a4bb8 instanceof _0x3caea6))throw new _0x3d1adc('parameter\x20stop\x20must\x20be\x20instanceof\x20RouteStop!');this['_stopCollection']['set'](_0x5a4bb8['index'],_0x5a4bb8);if(_0x46fc97(this['_entityCollection'])&&this['_isStopVisible']){const _0x3a3292=this['_entityCollection']['add']({'position':_0x5a4bb8['point'],'billboard':{'image':_0x2cbcd7('Assets/Textures/grepin.png'),'scale':0.5}});this['_stopMarkCollection']['push'](_0x3a3292);}if(this['_isCleared']&&this['_stopCollection']['length']>0x2){if(_0x46fc97(this['_catmullRomSpline'])){const _0x27dec9=[]['concat'](this['_catmullRomSpline']['times']);let _0x2e04ee=[]['concat'](this['_catmullRomSpline']['points']),_0x21996d=this['_stopCollection']['length']>0x0?this['_stopCollection']['_array'][this['_stopCollection']['length']-0x2]['_duration']:0x0,_0x58e9da=_0x27dec9['length']>0x0?_0x27dec9[_0x27dec9['length']-0x1]:0x0;_0x27dec9['push'](_0x58e9da+_0x21996d),_0x2e04ee['push'](_0x5a4bb8['point']),this['_catmullRomSpline']=new Cesium['CatmullRomSpline']({'times':_0x27dec9,'points':_0x2e04ee});}else{let _0xdd75a4=[0x0],_0x51cd36=[this['_stopCollection']['_array'][0x0]['point']],_0x33c471=0x0;for(let _0x4ac743=0x1;_0x4ac743<this['_stopCollection']['length'];_0x4ac743++){let _0x28f9d7=this['_stopCollection']['_array'][_0x4ac743],_0x3bc7f2=this['_stopCollection']['_array'][_0x4ac743-0x1];_0x51cd36['push'](_0x28f9d7['point']),_0x33c471+=_0x3bc7f2['duration'],_0xdd75a4['push'](_0x33c471);}this['_catmullRomSpline']=new CatmullRomSpline({'times':_0xdd75a4,'points':_0x51cd36});}}return!![];},_0x44dd8a['prototype']['addStop']=function(_0x19bf85){if(!_0x19bf85)throw new _0x3d1adc('parameter\x20stop\x20is\x20required!');if(!(_0x19bf85 instanceof _0x3caea6))throw new _0x3d1adc('parameter\x20stop\x20must\x20be\x20instanceof\x20RouteStop!');_0x19bf85['_preStopIndex']=this['_stopsInfo']['stopNodes']['length']+this['_addedStops']['length']-0x1,_0x19bf85['_index']=_0x19bf85['_preStopIndex']+0x1,this['_addedStops']['push'](_0x19bf85),this['clear'](),this['init'](),this['setLineVisible']();},_0x44dd8a['prototype']['removeStop']=function(_0x21080b){this['clear'](),this['_removeIndex']['indexOf'](_0x21080b['index'])===-0x1&&this['_removeIndex']['push'](_0x21080b['index']),this['init'](),this['setLineVisible']();},_0x44dd8a['prototype']['setLineVisible']=function(){if(!_0x46fc97(this['_entityCollection']))return;if(!_0x46fc97(this['_lineEntity'])){let _0x27c37e=this['stopCollection'],_0x40c66b=_0x27c37e['length'],_0x2eb95a=[];while(_0x40c66b--){_0x2eb95a['push'](_0x27c37e[_0x40c66b]['point']);}this['_lineEntity']=this['_entityCollection']['add']({'name':this['routeName'],'polyline':{'positions':_0x2eb95a,'width':0x5}});}this['_lineEntity']['show']=this['_isLineVisible'];},_0x44dd8a['prototype']['setStopVisible']=function(){if(!_0x46fc97(this['_entityCollection']))return;if(this['_stopMarkCollection']['length']===0x0&&this['_isStopVisible']){const _0xd70daf=this['stopCollection'];let _0x10388a=_0xd70daf['length'];while(_0x10388a--){const _0xf27d92=_0xd70daf[_0x10388a];let _0x42a357=this['_entityCollection']['add']({'position':_0xf27d92['point'],'billboard':{'image':_0x2cbcd7('Assets/Textures/grepin.png'),'scale':0.5}});this['_stopMarkCollection']['push'](_0x42a357);}}for(let _0x3c9831=0x0,_0x44cd83=this['_stopMarkCollection']['length'];_0x3c9831<_0x44cd83;_0x3c9831++){let _0x92d335=this['_stopMarkCollection'][_0x3c9831];_0x92d335['show']=this['_isStopVisible'];}},_0x44dd8a['prototype']['get']=function(_0x219bd7){return this['_stopCollection']['get'](_0x219bd7)===undefined?this['stopCollection'][_0x219bd7]:this['_stopCollection']['get'](_0x219bd7);},_0x44dd8a['prototype']['clear']=function(){this['_isCleared']=!![];for(let _0x263acb=0x0;_0x263acb<this['_stopMarkCollection']['length'];_0x263acb++){this['_entityCollection']['remove'](this['_stopMarkCollection'][_0x263acb]);}_0x46fc97(this['_lineEntity'])&&(this['_entityCollection']['remove'](this['_lineEntity']),this['_lineEntity']=undefined),this['_stopCollection']['removeAll'](),_0x46fc97(this['_catmullRomSpline'])&&(this['_catmullRomSpline']=undefined);};export default _0x44dd8a;