const _0x5c68bf=(function(){let _0x4b0bee=!![];return function(_0x5b4a19,_0xc78c56){const _0x438181=_0x4b0bee?function(){if(_0xc78c56){const _0x10ba42=_0xc78c56['apply'](_0x5b4a19,arguments);return _0xc78c56=null,_0x10ba42;}}:function(){};return _0x4b0bee=![],_0x438181;};}()),_0x47b2b5=_0x5c68bf(this,function(){return _0x47b2b5['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](_0x47b2b5)['search']('(((.+)+)+)+$');});_0x47b2b5();import _0x1e5354 from'./RouteStop.js';import _0x383aae from'../Ext/buildModuleUrl.js';import _0x3d36a5 from'../Ext/XmlParser.js';import _0x2ffc72 from'./StopPlayMode.js';import _0x519aa5 from'../Mixin/Common.js';const _0x37958e=Cesium['DeveloperError'],_0x4ae203=Cesium['Cartesian3'],_0x1d45e1=Cesium['defaultValue'],_0x194be5=Cesium['defined'],_0x26451e=Cesium['Math'],_0x3fd2dc=Cesium['Transforms'],_0x4cb447=Cesium['AssociativeArray'];function _0x204745(_0x25bf46){_0x25bf46=_0x25bf46||{},this['_stopCollection']=new _0x4cb447(),this['_isStopVisible']=_0x1d45e1(_0x25bf46['isStopVisible'],![]),this['_stopMarkCollection']=[],this['_isFlyLoop']=_0x1d45e1(_0x25bf46['isFlyLoop'],![]),this['_isLineVisible']=_0x1d45e1(_0x25bf46['isLineVisible'],![]),this['_lineEntity']=undefined,this['_routeName']=_0x1d45e1(_0x25bf46['routeName'],''),this['_speed']=_0x1d45e1(_0x25bf46['speed'],0x32),this['_isAlongline']=_0x1d45e1(_0x25bf46['isAlongline'],![]),this['_totalDuration']=_0x1d45e1(_0x25bf46['totalDuration'],0x0),this['_isHeadingFree']=!this['_isAlongline']&&_0x1d45e1(_0x25bf46['isHeadingFree'],![]),this['_isTiltFree']=_0x1d45e1(_0x25bf46['isTiltFree'],![]),this['_isAltitudeFree']=_0x1d45e1(_0x25bf46['isAltitudeFree'],![]),this['_entityCollection']=_0x25bf46['entityCollection'],this['_catmullRomSpline']=undefined,this['_isCleared']=![],this['_stopsInfo']=_0x1d45e1(_0x25bf46['stopsInfo'],{}),this['_removeIndex']=[],this['_addedStops']=[];}Object['defineProperties'](_0x204745['prototype'],{'stopCollection':{'get':function(){return this['_stopCollection']['values'];}},'isStopVisible':{'get':function(){return this['_isStopVisible'];},'set':function(_0x4ba59f){_0x194be5(_0x4ba59f)&&_0x4ba59f!==this['_isStopVisible']&&(this['_isStopVisible']=_0x4ba59f,this['setStopVisible']());}},'isFlyLoop':{'get':function(){return this['_isFlyLoop'];},'set':function(_0x5f67ab){_0x5f67ab&&(this['_isFlyLoop']=_0x5f67ab);}},'isLineVisible':{'get':function(){return this['_isLineVisible'];},'set':function(_0x5ba127){_0x194be5(_0x5ba127)&&_0x5ba127!==this['_isLineVisible']&&(this['_isLineVisible']=_0x5ba127,this['setLineVisible']());}},'lineEntity':{'get':function(){return this['_lineEntity'];},'set':function(_0x55a6ee){_0x194be5(_0x55a6ee)&&(this['_lineEntity']=_0x55a6ee);}},'routeName':{'get':function(){return this['_routeName'];},'set':function(_0x45cc82){_0x45cc82&&(this['_routeName']=_0x45cc82);}},'speed':{'get':function(){return this['_speed'];},'set':function(_0xd847fd){if(_0xd847fd&&_0xd847fd!=this['_speed']){this['_speed']=_0xd847fd;let _0x1b9e1a=this['speed'],_0x14a447=this['stopCollection'];for(let _0x5b0658=0x0,_0x2a5f9f=_0x14a447['length'];_0x5b0658<_0x2a5f9f-0x1;_0x5b0658++){let _0x41d736=_0x14a447[_0x5b0658];_0x41d736['duration']=Math['ceil'](_0x41d736['distanceToNext']/_0x1b9e1a);}}}},'stopCount':{'get':function(){return this['_stopCollection']['length'];}},'isAlongline':{'get':function(){return this['_isAlongline'];},'set':function(_0xcf5de5){_0x194be5(_0xcf5de5)&&(this['_isAlongline']=_0xcf5de5);}},'totalDuration':{'get':function(){return this['_totalDuration'];}},'isHeadingFree':{'get':function(){return this['_isHeadingFree'];},'set':function(_0x572226){_0x194be5(_0x572226)&&(this['_isHeadingFree']=_0x572226);}},'isTiltFree':{'get':function(){return this['_isTiltFree'];},'set':function(_0x47d8d9){_0x194be5(_0x47d8d9)&&(this['_isTiltFree']=_0x47d8d9);}},'isAltitudeFree':{'get':function(){return this['_isAltitudeFree'];},'set':function(_0x31c59d){_0x194be5(_0x31c59d)&&(this['_isAltitudeFree']=_0x31c59d);}}}),_0x204745['prototype']['init']=function(){let _0x4f9abb=0x0,_0x2320c6=[0x0],_0xd95742=[],_0x2d63d4=this['_stopsInfo']['stopNodes'];const _0x4099a9=this['_stopsInfo']['namespace'];_0x194be5(_0x2d63d4)?_0x2d63d4=_0x2d63d4['concat'](this['_addedStops']):_0x2d63d4=this['_addedStops'];for(let _0x1f241f=0x0;_0x1f241f<_0x2d63d4['length'];_0x1f241f++){if(this['_removeIndex']['indexOf'](_0x1f241f)>-0x1)continue;let _0x82ca1e=_0x2d63d4[_0x1f241f],_0x2801fb,_0x26f9ba,_0x5e15a9;if(!(_0x82ca1e instanceof _0x1e5354)){let _0x1f3633=_0x3d36a5['queryFirstNode'](_0x82ca1e,'camera',_0x4099a9);const _0x5e1375=_0x3d36a5['queryNumericValue'](_0x1f3633,'longitude',_0x4099a9),_0x3cd559=_0x3d36a5['queryNumericValue'](_0x1f3633,'latitude',_0x4099a9),_0x365369=_0x3d36a5['queryNumericValue'](_0x1f3633,'altitude',_0x4099a9);let _0x1713d8=_0x3d36a5['queryNumericValue'](_0x1f3633,'heading',_0x4099a9);_0x1713d8=_0x26451e['toRadians'](_0x1713d8);let _0x215fe1=_0x3d36a5['queryNumericValue'](_0x1f3633,'tilt',_0x4099a9);_0x215fe1=_0x26451e['toRadians'](_0x215fe1-0x5a);this['_isAlongline']&&!this['_isTiltFree']&&(_0x215fe1=0x0);const _0x5167f4=_0x3d36a5['queryStringValue'](_0x1f3633,'altitudeMode',_0x4099a9),_0x20ffd5=_0x3d36a5['queryStringAttribute'](_0x82ca1e,'name'),_0x5349d6=_0x3d36a5['queryNumericAttribute'](_0x82ca1e,'speed',_0x4099a9),_0x35ff9c=_0x3d36a5['queryFirstNode'](_0x82ca1e,'setting',_0x4099a9);_0x5e15a9=_0x3d36a5['queryStringValue'](_0x35ff9c,'stopPlayMode',_0x4099a9);const _0x21eb55=_0x3d36a5['queryNumericValue'](_0x35ff9c,'pauseTime',_0x4099a9),_0x5298ce=_0x3d36a5['queryNumericValue'](_0x35ff9c,'angularSpeed',_0x4099a9),_0x57cc86=_0x3d36a5['queryFirstNode'](_0x35ff9c,'stopViews',_0x4099a9);let _0x5dfcf6,_0x1de8f6=!![];_0x5e1375>0xb4||_0x3cd559>0xb4?(_0x5dfcf6=new _0x4ae203(_0x5e1375,_0x3cd559,_0x365369),_0x1de8f6=![]):_0x5dfcf6=_0x4ae203['fromDegrees'](_0x5e1375,_0x3cd559,_0x365369);_0xd95742['push'](_0x5dfcf6);let _0x9b1f3e=this['stopCount'];if(_0x1f241f>0x0&&_0x9b1f3e>0x0){_0x26f9ba=this['_stopCollection']['_array'][this['_stopCollection']['length']-0x1];if(_0x26f9ba['stopPlayMode']!=_0x2ffc72['StopAround']){const _0x4c0d6c=_0x26f9ba['point'],_0x67f637=_0x4ae203['distance'](_0x4c0d6c,_0x5dfcf6);_0x26f9ba['distanceToNext']=_0x67f637;let _0x55ee09=_0x26f9ba['speed'],_0x5bffaa;0x0<_0x55ee09?_0x5bffaa=_0x55ee09:_0x5bffaa=this['_speed'],_0x26f9ba['duration']=_0x67f637/_0x5bffaa,_0x26f9ba['speed']=_0x5bffaa,_0x4f9abb+=_0x26f9ba['duration'],_0x2320c6['push'](_0x4f9abb);}}_0x2801fb=new _0x1e5354({'index':_0x1f241f,'point':_0x5dfcf6,'heading':_0x1713d8,'tilt':_0x215fe1,'stopName':_0x20ffd5,'waitTime':_0x21eb55,'speed':_0x5349d6,'isConvert':_0x1de8f6}),_0x2801fb['altitude']=_0x365369;}else _0x2801fb=_0x82ca1e;this['_addStop'](_0x2801fb);_0x194be5(_0x26f9ba)&&(_0x26f9ba['_nextStopIndex']=_0x1f241f,_0x2801fb['_preStopIndex']=_0x26f9ba['index']);if(_0x5e15a9===_0x2ffc72['StopAround']&&stopsViesNode){const _0x5ce7c8=queryChildNodes(stopsViesNode,'view',_0x4099a9);if(_0x5ce7c8['length']==0x2){const _0x4f9708=_0x5ce7c8[0x0],_0xadae3c=_0x5ce7c8[0x1],_0x4dca40=_0x3d36a5['queryNumericAttribute'](_0x4f9708,'heading',_0x4099a9),_0x5b19b8=_0x3d36a5['queryNumericAttribute'](_0xadae3c,'heading',_0x4099a9),_0x12f9e=_0x3d36a5['queryNumericAttribute'](_0x4f9708,'tilt',_0x4099a9),_0x203626=_0x3d36a5['queryNumericAttribute'](_0xadae3c,'tilt',_0x4099a9),_0x128333=_0x3d36a5['queryNumericAttribute'](_0x4f9708,'altitude',_0x4099a9),_0x1bfe5f=_0x3d36a5['queryNumericAttribute'](_0xadae3c,'altitude',_0x4099a9),_0x1bf56b=_0x3d36a5['queryStringAttribute'](_0x4f9708,'direction',_0x4099a9),_0x13b9f1=_0x3d36a5['queryStringAttribute'](_0xadae3c,'direction',_0x4099a9);let _0x529208,_0x1c25f4=_0x1bf56b==='Clockwise'?0x1:-0x1;if(_0x26451e['equalsEpsilon'](_0x4dca40,_0x5b19b8,_0x26451e['EPSILON15']))_0x529208=0x168;else{_0x529208=_0x5b19b8-_0x4dca40;if(_0x529208<0x0&&_0x1bf56b==='Clockwise')_0x529208+=0x168;else _0x529208>0x0&&_0x1bf56b!=='Clockwise'&&(_0x529208=0x168-_0x529208);_0x529208=Math['abs'](_0x529208);}const _0x4c5c93=_0x529208/angularSpeed;_0x2801fb['surroundDuration']=_0x4c5c93/0x3,_0x2801fb['stopPlayMode']=_0x2ffc72['StopAround'];const _0x1a30b6=_0x26451e['toRadians'](_0x4dca40),_0x54ee29=_0x26451e['toRadians'](_0x4dca40+_0x1c25f4*_0x529208/0x3),_0x2b49d1=_0x26451e['toRadians'](_0x4dca40+_0x1c25f4*_0x529208*0x2/0x3),_0x3d493a=_0x26451e['toRadians'](_0x5b19b8),_0x1f08c2=new _0x1e5354({'point':point,'heading':_0x1a30b6,'tilt':tilt,'stopName':stopName,'waitTime':waitTime,'speed':stopSpeed,'surroundDuration':_0x4c5c93/0x3,'stopPlayMode':_0x2ffc72['StopAround']});_0x1f08c2['_bImmediately']=!![],_0x1f08c2['_isGenerated']=!![],this['_addStop'](_0x1f08c2);let _0x35ab35=new _0x1e5354({'point':point,'heading':_0x54ee29,'tilt':tilt,'stopName':stopName,'waitTime':0x0,'speed':stopSpeed,'surroundDuration':_0x4c5c93/0x3,'stopPlayMode':_0x2ffc72['StopAround']});_0x35ab35['_isGenerated']=!![],this['_addStop'](_0x35ab35);let _0x52d310=new _0x1e5354({'point':point,'heading':_0x2b49d1,'tilt':tilt,'stopName':stopName,'waitTime':0x0,'speed':stopSpeed,'surroundDuration':_0x4c5c93/0x3,'stopPlayMode':_0x2ffc72['StopAround']});_0x52d310['_isGenerated']=!![],this['_addStop'](_0x52d310);let _0x561dee=new _0x1e5354({'point':point,'heading':_0x3d493a,'tilt':tilt,'stopName':stopName,'waitTime':waitTime,'speed':stopSpeed});this['_addStop'](_0x561dee),_0x4f9abb+=_0x4c5c93;}}}if(this['_isAlongline']){for(let _0x5bc65e=0x0;_0x5bc65e<this['stopCount']-0x1;_0x5bc65e++){let _0xfb8113=this['stopCollection'][_0x5bc65e];const _0x4645b7=this['stopCollection'][_0x5bc65e+0x1],_0x59a626=new _0x4ae203(_0x4645b7['point']['x']-_0xfb8113['point']['x'],_0x4645b7['point']['y']-_0xfb8113['point']['y'],_0x4645b7['point']['z']-_0xfb8113['point']['z']);_0x4ae203['normalize'](_0x59a626,_0x59a626),_0xfb8113['direction']=_0x59a626,_0xfb8113['up']=_0x519aa5(_0xfb8113['point'],_0x59a626),this['_isTiltFree']&&(_0xfb8113['heading']=_0x3fd2dc['getHeading'](_0xfb8113['direction'],_0xfb8113['up'])-_0x26451e['PI']);}if(this['stopCount']>0x2){let _0x16e2d9=this['stopCollection'][this['stopCollection']['length']-0x1];const _0x199e96=this['stopCollection'][this['stopCollection']['length']-0x2];_0x16e2d9['direction']=_0x199e96['direction'],_0x16e2d9['up']=_0x199e96['up'],this['_isTiltFree']&&(_0x16e2d9['heading']=_0x3fd2dc['getHeading'](_0x16e2d9['direction'],_0x16e2d9['up'])-_0x26451e['PI']);}}_0xd95742['length']>=0x2&&(this['_catmullRomSpline']=new Cesium['CatmullRomSpline']({'times':_0x2320c6,'points':_0xd95742})),this['setStopVisible'](),this['_totalDuration']=_0x4f9abb;},_0x204745['prototype']['_addStop']=function(_0x3b95a9){if(!_0x3b95a9)throw new _0x37958e('parameter\x20stop\x20is\x20required!');if(!(_0x3b95a9 instanceof _0x1e5354))throw new _0x37958e('parameter\x20stop\x20must\x20be\x20instanceof\x20RouteStop!');this['_stopCollection']['set'](_0x3b95a9['index'],_0x3b95a9);if(_0x194be5(this['_entityCollection'])&&this['_isStopVisible']){const _0x1e0ba5=this['_entityCollection']['add']({'position':_0x3b95a9['point'],'billboard':{'image':_0x383aae('Assets/Textures/grepin.png'),'scale':0.5}});this['_stopMarkCollection']['push'](_0x1e0ba5);}if(this['_isCleared']&&this['_stopCollection']['length']>0x2){if(_0x194be5(this['_catmullRomSpline'])){const _0x34fda4=[]['concat'](this['_catmullRomSpline']['times']);let _0x5a35d4=[]['concat'](this['_catmullRomSpline']['points']),_0xde57cc=this['_stopCollection']['length']>0x0?this['_stopCollection']['_array'][this['_stopCollection']['length']-0x2]['_duration']:0x0,_0x283d36=_0x34fda4['length']>0x0?_0x34fda4[_0x34fda4['length']-0x1]:0x0;_0x34fda4['push'](_0x283d36+_0xde57cc),_0x5a35d4['push'](_0x3b95a9['point']),this['_catmullRomSpline']=new Cesium['CatmullRomSpline']({'times':_0x34fda4,'points':_0x5a35d4});}else{let _0x20611f=[0x0],_0x1f051a=[this['_stopCollection']['_array'][0x0]['point']],_0x17e756=0x0;for(let _0x125030=0x1;_0x125030<this['_stopCollection']['length'];_0x125030++){let _0x264cff=this['_stopCollection']['_array'][_0x125030],_0x53dae4=this['_stopCollection']['_array'][_0x125030-0x1];_0x1f051a['push'](_0x264cff['point']),_0x17e756+=_0x53dae4['duration'],_0x20611f['push'](_0x17e756);}this['_catmullRomSpline']=new CatmullRomSpline({'times':_0x20611f,'points':_0x1f051a});}}return!![];},_0x204745['prototype']['addStop']=function(_0x4d2505){if(!_0x4d2505)throw new _0x37958e('parameter\x20stop\x20is\x20required!');if(!(_0x4d2505 instanceof _0x1e5354))throw new _0x37958e('parameter\x20stop\x20must\x20be\x20instanceof\x20RouteStop!');_0x4d2505['_preStopIndex']=this['_stopsInfo']['stopNodes']['length']+this['_addedStops']['length']-0x1,_0x4d2505['_index']=_0x4d2505['_preStopIndex']+0x1,this['_addedStops']['push'](_0x4d2505),this['clear'](),this['init'](),this['setLineVisible']();},_0x204745['prototype']['removeStop']=function(_0x415600){this['clear'](),this['_removeIndex']['indexOf'](_0x415600['index'])===-0x1&&this['_removeIndex']['push'](_0x415600['index']),this['init'](),this['setLineVisible']();},_0x204745['prototype']['setLineVisible']=function(){if(!_0x194be5(this['_entityCollection']))return;if(!_0x194be5(this['_lineEntity'])){let _0x2900d4=this['stopCollection'],_0x3de00d=_0x2900d4['length'],_0x389b3e=[];while(_0x3de00d--){_0x389b3e['push'](_0x2900d4[_0x3de00d]['point']);}this['_lineEntity']=this['_entityCollection']['add']({'name':this['routeName'],'polyline':{'positions':_0x389b3e,'width':0x5}});}this['_lineEntity']['show']=this['_isLineVisible'];},_0x204745['prototype']['setStopVisible']=function(){if(!_0x194be5(this['_entityCollection']))return;if(this['_stopMarkCollection']['length']===0x0&&this['_isStopVisible']){const _0x37915b=this['stopCollection'];let _0x1ad33a=_0x37915b['length'];while(_0x1ad33a--){const _0x1a06a7=_0x37915b[_0x1ad33a];let _0xf456a2=this['_entityCollection']['add']({'position':_0x1a06a7['point'],'billboard':{'image':_0x383aae('Assets/Textures/grepin.png'),'scale':0.5}});this['_stopMarkCollection']['push'](_0xf456a2);}}for(let _0x5632c4=0x0,_0x399911=this['_stopMarkCollection']['length'];_0x5632c4<_0x399911;_0x5632c4++){let _0x3c92d6=this['_stopMarkCollection'][_0x5632c4];_0x3c92d6['show']=this['_isStopVisible'];}},_0x204745['prototype']['get']=function(_0x4dd8c1){return this['_stopCollection']['get'](_0x4dd8c1)===undefined?this['stopCollection'][_0x4dd8c1]:this['_stopCollection']['get'](_0x4dd8c1);},_0x204745['prototype']['clear']=function(){this['_isCleared']=!![];for(let _0x26e58e=0x0;_0x26e58e<this['_stopMarkCollection']['length'];_0x26e58e++){this['_entityCollection']['remove'](this['_stopMarkCollection'][_0x26e58e]);}_0x194be5(this['_lineEntity'])&&(this['_entityCollection']['remove'](this['_lineEntity']),this['_lineEntity']=undefined),this['_stopCollection']['removeAll'](),_0x194be5(this['_catmullRomSpline'])&&(this['_catmullRomSpline']=undefined);};export default _0x204745;